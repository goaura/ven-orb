description: >
  Installs 'ven' and dependencies

steps:
  - run:
      name: Configure git
      command: git config --global url."git@github.com/".insteadOf "https://github.com/"
  - run:
      name: Install terraform
      # From https://www.terraform.io/docs/cli/install/apt.html
      command: |
        curl -fsSL https://apt.releases.hashicorp.com/gpg | sudo apt-key add -
        sudo apt-add-repository "deb [arch=$(dpkg --print-architecture)] https://apt.releases.hashicorp.com $(lsb_release -cs) main"
        sudo apt install terraform
        terraform --version
  - run:
      name: Install ven
      # Not sure why 'go install github.com/vendrive/ven@latest' doesn't work
      command: |
        cd /tmp
        git clone git@github.com:vendrive/ven.git
        cd ven
        go install
        ven --version

